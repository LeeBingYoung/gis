$(function () {

    Highcharts.setOptions({
        global: {
            useUTC: false
        }
    });

    function activeLastPointToolip(chart) {
        var points = chart.series[0].points;
        chart.tooltip.refresh(points[points.length - 1]);
    }

    $('#chart-location').highcharts({
        chart: {
            type: 'spline',
            backgroundColor: '',
            animation: Highcharts.svg, // don't animate in old IE
            marginRight: 10,
            events: {
                load: function () {
                    // set up the updating of the chart each second
                    var series = this.series[0],
                        chart = this,
                        i = 0,
                        ydata = new Array(1750.66130995444, 1708.9977832796458, 1667.3346374348948, 1625.671901700225, 1584.0096084358718, 1542.3477934981995, 1500.6864967248923, 1459.0257625032393, 1417.3656404386102, 1375.7061861443408, 1334.047462179561, 1292.3895391683234, 1274.2149338449703, 1259.19469026163, 1244.1745692091506, 1229.1545751794692, 1214.1347128867626, 1199.1149872813592, 1184.0954035647128, 1169.0759672055271, 1154.0566839571404, 1139.0375598762828, 1124.018601343338, 1108.9998150842523, 1093.9812081942407, 1086.313339513423, 1082.1955903982441, 1078.0778581038896, 1073.9601428238416, 1069.8424447545588, 1065.7247640955356, 1061.6071010493608, 1057.489455821778, 1053.3718286217459, 1049.2542196615034, 1045.136629156633, 1041.0190573261266, 1042.2646389927295, 1046.1604592589063, 1050.0562908098045, 1053.9521335202862, 1057.847987267055, 1061.7438519286254, 1065.639727385287, 1069.5356135190736, 1073.4315102137314, 1077.3274173546877, 1076.7596932249069, 1073.3896796564184, 1070.0196778895656, 1066.6496880362079, 1063.2797102096217, 1059.909744524525, 1056.5397910970973, 1053.1698500450066, 1049.7999214874294, 1046.4300055450783, 1043.060102340225, 1039.7706330936976, 1052.737905216055, 1065.7053343581001, 1078.6729148569248, 1091.6406413186357, 1104.6085086025694, 1117.5765118066076, 1130.5446462535037, 1143.512907478135, 1156.481291215616, 1169.4497933902, 1182.4184101049113, 1195.387137631853, 1208.355972403135, 1218.7611412443218, 1233.8806994636736, 1249.0003804590297, 1264.1201798249526, 1279.2400933642493, 1294.3601170758118, 1309.4802471433006, 1324.6004799246007, 1339.7208119419952, 1354.841239872993, 1369.9617605417648, 1376.8063195179686, 1374.7308635999327, 1372.65541087801, 1370.579961366721, 1368.5045150806723, 1366.429072034561, 1364.3536322431721, 1362.2970465102942, 1366.061455195863, 1369.8258683549564, 1373.590285950795, 1377.3547079470009, 1381.1191343075923, 1384.8835649969792, 1388.6479999799576, 1392.4124392217034, 1396.1768826877687, 1399.9413303440767);

                    setInterval(function () {
                        var x = (new Date()).getTime(), // current time
                            y = ydata[i];
                        i = (i + 1) % 50;
                        series.addPoint([x, y], true, true);
                        activeLastPointToolip(chart)
                    }, 1000);
                }
            }
        },
        title: {
            text: '目标实时数据',
            style: {"color": "white", "fontSize": "0px"}
        },
        xAxis: {
            type: 'datetime',
            tickPixelInterval: 150
        },
        yAxis: {
            title: {
                text: '与原点距离（m）'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },
        tooltip: {
            formatter: function () {
                return '<b>' + this.series.name + '</b><br/>' +
                    Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
                    Highcharts.numberFormat(this.y, 2);
            }
        },
        legend: {
            enabled: false
        },
        exporting: {
            enabled: false
        },
        credits: {
            enabled: false
        },
        series: [{
            name: '位置',
            data: (function () {
                // generate an array of random data
                var data = [],
                    time = (new Date()).getTime(),
                    i;
                for (i = -19; i <= 0; i += 1) {
                    data.push({
                        x: time + i * 1000,
                        y: 0
                    })
                    ;
                }
                return data;
            }())
        }]
    }, function (c) {
        activeLastPointToolip(c)
    });
})